<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Countdown with Javascript</title> <meta name="author" content="Brendan Sudol"> <meta name="keywords" content=""> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Countdown with Javascript"> <meta property="og:description" content="Countdown with Javascript"> <meta property="og:url" content="https://www.brendansudol.com/writing/countdown-to-awesome-w-js"> <meta property="og:site_name" content="Brendan Sudol"> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@"> <meta name="twitter:title" content="Countdown with Javascript"> <meta name="twitter:description" content="Countdown with Javascript"> <meta name="twitter:url" content="https://www.brendansudol.com/writing/countdown-to-awesome-w-js"> <meta name="twitter:image" content="https://www.brendansudol.com/assets/img/misc/bren-doodle-color.png"> <link rel="stylesheet" href="/assets/css/all.css?202012212348"> </head> <body class='site'> <header class='container mx-auto px2 py3 mb2 col-12'> <a href='/' class='h2 bold black mono js-name'>Brendan Sudol</a> </header> <div class='site-wrap'> <div class='container mx-auto px2'><div class="h6 gray">November 2014</div> <h1 class="mt0 mb3 h2 sm-h0">Countdown with Javascript</h1> <article class="mb3"><p>Have something memorable coming up? Want to keep track of it online and get excited as the big day approaches?</p> <p>Well I did, so I made a simple javascript function that does just that. It’s in pure javascript (no jQuery or other dependencies) and here’s the output:</p> <div class="mb2" id="countdown"> </div> <p>To use it, you just specify the date you want to count down towards and the id of the element in the DOM where it’ll go. For example:</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"> <span class="nx">countdown</span><span class="p">(</span><span class="s2">"11-21-2014"</span><span class="p">,</span> <span class="s2">"countdown"</span><span class="p">);</span> </code></pre></figure> <p>And here’s the function you can drop into your site to power it:</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">countdown</span><span class="p">(</span><span class="nx">date_str</span><span class="p">,</span> <span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">ctdn</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">deadline</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">date_str</span><span class="p">),</span>
        <span class="nx">tz_offset</span> <span class="o">=</span> <span class="nx">deadline</span><span class="p">.</span><span class="nx">getTimezoneOffset</span><span class="p">()</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">;</span>

    <span class="kd">function</span> <span class="nx">formatTime</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">toTimeString</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/.*</span><span class="se">(\d{2}</span><span class="sr">:</span><span class="se">\d{2}</span><span class="sr">:</span><span class="se">\d{2})</span><span class="sr">.*/</span><span class="p">,</span> <span class="s2">"$1"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">formatDay</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">days</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="o">+</span><span class="nx">d</span> <span class="o">/</span> <span class="p">(</span><span class="mi">24</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">));</span>
        <span class="k">return</span> <span class="nx">days</span> <span class="o">===</span> <span class="mi">0</span> <span class="p">?</span> <span class="s1">''</span> <span class="p">:</span> <span class="nx">days</span> <span class="o">+</span> <span class="p">(</span><span class="nx">days</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">?</span> <span class="s1">' days, '</span> <span class="p">:</span> <span class="s1">' day, '</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">tick</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">now</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">,</span>
            <span class="nx">d_diff</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="o">+</span><span class="nx">deadline</span> <span class="o">+</span> <span class="nx">tz_offset</span> <span class="o">+</span> <span class="o">-</span><span class="nx">now</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">+</span><span class="nx">d_diff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="nx">ctdn</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'boom'</span><span class="p">;</span>

        <span class="nx">ctdn</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">formatDay</span><span class="p">(</span><span class="nx">d_diff</span><span class="p">)</span> <span class="o">+</span> <span class="nx">formatTime</span><span class="p">(</span><span class="nx">d_diff</span><span class="p">);</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">tick</span><span class="p">,</span> <span class="mi">1000</span> <span class="o">-</span> <span class="nx">now</span> <span class="o">%</span> <span class="mi">1000</span><span class="p">);</span>  
    <span class="p">}</span>

    <span class="nx">tick</span><span class="p">();</span>
<span class="p">}</span></code></pre></figure> <p>Happy counting down to awesome things :)</p> </article> <script src="/assets/build/countdown.js"></script> </div> </div> <footer class="container mx-auto p2 mt4 col-12 h5 flex items-center"> <a class="mr2 black underline" href="/">Home</a> <a class="mr2 black underline" href="/writing/">Writing</a> <a class="mr2 black underline" href="https://github.com/brendansudol">Github</a> <a class="mr2 black underline" href="https://twitter.com/brensudol">Twitter</a> <a href="https://getwemoji.com/" target="_blank"> <img class="align-middle" src="/assets/img/misc/peace.gif" width="24" /> </a> </footer> <script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-37353161-5']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> <script src="/assets/misc/fun.js"></script> </body> </html>
<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Responsive D3.js</title> <meta name="author" content="Brendan Sudol"> <meta name="keywords" content=""> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Responsive D3.js"> <meta property="og:description" content="Responsive D3.js"> <meta property="og:url" content="https://www.brendansudol.com/writing/responsive-d3"> <meta property="og:site_name" content="Brendan Sudol"> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@"> <meta name="twitter:title" content="Responsive D3.js"> <meta name="twitter:description" content="Responsive D3.js"> <meta name="twitter:url" content="https://www.brendansudol.com/writing/responsive-d3"> <meta name="twitter:image" content="https://www.brendansudol.com/assets/img/misc/bren-doodle-color.png"> <link rel="preload" href="/assets/fonts/iAWriterQuattroS-Regular.woff2" as="font" type="font/woff2" crossOrigin="anonymous" /> <link rel="stylesheet" href="/assets/css/all.css?202103071420"> </head> <body class='site'> <header class='container mx-auto px2 py3 mb2 col-12'> <a href='/' class='h3 bold black'>Brendan Sudol</a> </header> <div class='site-wrap'> <div class='container mx-auto px2'><div class="h6 gray">November 2014</div> <h1 class="mt0 mb3 h2 sm-h0">Responsive D3.js</h1> <article class="mb3"><p>The only thing better than a nice, interactive D3 widget is one that’s mobile friendly. There are a variety of ways (using Javascript / CSS) to achieve this responsiveness. Here’s the way I do it when I’m making a visualization (no jQuery required):</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">responsivefy</span><span class="p">(</span><span class="nx">svg</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// get container + svg aspect ratio</span>
    <span class="kd">var</span> <span class="nx">container</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">svg</span><span class="p">.</span><span class="nx">node</span><span class="p">().</span><span class="nx">parentNode</span><span class="p">),</span>
        <span class="nx">width</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">svg</span><span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">"width"</span><span class="p">)),</span>
        <span class="nx">height</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">svg</span><span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">"height"</span><span class="p">)),</span>
        <span class="nx">aspect</span> <span class="o">=</span> <span class="nx">width</span> <span class="o">/</span> <span class="nx">height</span><span class="p">;</span>

    <span class="c1">// add viewBox and preserveAspectRatio properties,</span>
    <span class="c1">// and call resize so that svg resizes on inital page load</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"viewBox"</span><span class="p">,</span> <span class="s2">"0 0 "</span> <span class="o">+</span> <span class="nx">width</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="nx">height</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"perserveAspectRatio"</span><span class="p">,</span> <span class="s2">"xMinYMid"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">resize</span><span class="p">);</span>

    <span class="c1">// to register multiple listeners for same event type, </span>
    <span class="c1">// you need to add namespace, i.e., 'click.foo'</span>
    <span class="c1">// necessary if you call invoke this function for multiple svgs</span>
    <span class="c1">// api docs: https://github.com/mbostock/d3/wiki/Selections#on</span>
    <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s2">"resize."</span> <span class="o">+</span> <span class="nx">container</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"id"</span><span class="p">),</span> <span class="nx">resize</span><span class="p">);</span>

    <span class="c1">// get width of container and resize svg to fit it</span>
    <span class="kd">function</span> <span class="nx">resize</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">targetWidth</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">container</span><span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">"width"</span><span class="p">));</span>
        <span class="nx">svg</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"width"</span><span class="p">,</span> <span class="nx">targetWidth</span><span class="p">);</span>
        <span class="nx">svg</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"height"</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">targetWidth</span> <span class="o">/</span> <span class="nx">aspect</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure> <p>You can call this function when you add your SVG element to the page:</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">"#viz"</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s2">"svg"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"width"</span><span class="p">,</span> <span class="mi">960</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"height"</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">responsivefy</span><span class="p">);</span></code></pre></figure> <p>And for completeness, here’s a working example with a randomly updating donut chart — try shrinking your browser window to see it adapt :)</p> <div id="viz-responsive-demo"> </div> </article> <script src="/assets/build/d3.js"></script> <script src="/assets/build/responsiveD3.js"></script> </div> </div> <footer class="container mx-auto p2 mt4 col-12 h5 flex items-center"> <a class="mr2 black underline" href="/">Home</a> <a class="mr2 black underline" href="/writing/">Writing</a> <a class="mr2 black underline" href="https://github.com/brendansudol">Github</a> <a class="mr2 black underline" href="https://twitter.com/brensudol">Twitter</a> <a href="https://getwemoji.com/" target="_blank"> <img class="align-middle" src="/assets/img/misc/peace.gif" width="24" /> </a> </footer> <script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-37353161-5']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> </body> </html>